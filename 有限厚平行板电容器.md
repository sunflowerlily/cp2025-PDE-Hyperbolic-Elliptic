调查在有限厚平行板导体电容器中电荷密度分布。因为平行板电容器是导体，所以他们在表面仍是100V和-100V的等势面，现在平行板的厚度至少为2$\Delta$（$\Delta$为计算步长）。首先采用Gauss-Seidel SOR迭代法解拉普拉斯方程解出电势分布U（电势分布如下图（左）），然后将结果带入泊松方程$\nabla^2U(\vec{x})=-4\pi\rho(\vec{x})$, 求出电荷在平行板上下表面的分布（类似如下右图）。

![有限厚平行板电容器](有限厚平行板电容器.png)

### 参考答案
```python
import numpy as np, matplotlib.pyplot as plt
%config InlineBackend.figure_format = 'retina'  #提高inline图的分辨率, 图size相对小
def Poisson_iterate(xgrid,ygrid,w,d,dx, dy, tol=1e-6):
    """
    Iterate algrithm for Laplace equation
    ------------
    I, J: the total steps in x and y direction
    w: the width of the plates
    d: the distance between the plates
    """
    u = np.zeros((xgrid,ygrid))
    
    #平行板电容器的位置
    xL = (xgrid-w)//2 
    xR = (xgrid+w)//2
    yBb = (ygrid-d//2)//2
    yBa = (ygrid-d)//2
    yTb = (ygrid+d)//2
    yTa = (ygrid+d//2)//2
    
    deltaV=1.0
    while deltaV>tol: #迭代法
        uold = np.copy(u)
        
        u[1:-1,1:-1] = 0.25*(u[2:,1:-1] + u[0:-2,1:-1] 
                           + u[1:-1, 2:] + u[1:-1,0:-2])
        
        #re-establish the set potential of the plates
        u[xL:xR,yBa:yBb] = -100
        u[xL:xR,yTa:yTb] = 100
        #track the change in the matrix at each step to know when to quit
        deltaV=np.max(np.abs(u-uold))
    
    return u
I = J = 100
L = 100
w=50
d=40
x,y = np.mgrid[0:L:I*1j,0:L:J*1j] #x,y坐标 
u = Poisson_iterate(I,J,w,d,1,1)
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.plot_wireframe(x, y, u, rstride=3, cstride=3, color='r')
levels =np.linspace(u.min(),u.max(),20)
ax.contour(x, y, u, zdir = 'z', offset = u.min(),levels = levels)
ax.set_title('Laplace Iterate')
```

然后将结果带入泊松方程$\nabla^2U(\vec{x})=-4\pi\rho(\vec{x})$, 求出电荷在平行板上下表面的分布

```python
from scipy.ndimage import laplace
rho = laplace(u) #用拉普拉斯算符计算电荷密度
fig = plt.figure()
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(x, y, rho,cmap='coolwarm')
ax.set_title('Density of charges')
```