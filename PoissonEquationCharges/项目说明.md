# 项目：求解正负电荷构成的泊松方程

## 项目背景

本项目使用松弛迭代法求解二维泊松方程，模拟两个正方形电荷在二维箱子中产生的电势分布。这是计算物理中的经典问题，展示了椭圆型偏微分方程的数值求解方法。

## 学习目标

- 理解泊松方程的物理意义和数学形式
- 掌握有限差分法离散化偏微分方程
- 学习松弛迭代法求解线性方程组
- 熟练使用NumPy进行数值计算和Matplotlib进行可视化

## 物理问题

在一个二维正方形区域内，放置两个正方形电荷：
- 正电荷：电荷密度 $\rho = +1 \, \text{C/m}^2$，位置在网格 $(60:80, 20:40)$
- 负电荷：电荷密度 $\rho = -1 \, \text{C/m}^2$，位置在网格 $(20:40, 60:80)$
- 边界条件：四周边界电势为 0V
- 单位选择： $\varepsilon_0 = 1$

需要求解的泊松方程为：

$$\nabla^2 \phi = -\frac{\rho}{\varepsilon_0}$$

## 数值方法

### 有限差分离散化

使用中心差分格式将泊松方程离散化：

$$\frac{\phi_{i+1,j} - 2\phi_{i,j} + \phi_{i-1,j}}{h^2} + \frac{\phi_{i,j+1} - 2\phi_{i,j} + \phi_{i,j-1}}{h^2} = -\rho_{i,j}$$

整理得到迭代公式：

$$\phi_{i,j} = \frac{1}{4}(\phi_{i+1,j} + \phi_{i-1,j} + \phi_{i,j+1} + \phi_{i,j-1} + h^2\rho_{i,j})$$

### 松弛迭代法

1. 初始化电势数组，设置边界条件
2. 使用迭代公式更新内部网格点
3. 计算收敛判据： $\max|\phi^{(n+1)} - \phi^{(n)}| < 10^{-6}$
4. 重复迭代直到收敛

## 实现要求

### 函数设计

```python
def solve_poisson_equation(M=100, target=1e-6, max_iterations=10000):
    """
    使用松弛迭代法求解泊松方程
    
    参数:
        M (int): 每边的网格点数
        target (float): 收敛精度
        max_iterations (int): 最大迭代次数
    
    返回:
        phi (np.ndarray): 电势分布数组
        iterations (int): 实际迭代次数
        converged (bool): 是否收敛
    """
```

### 可视化要求

- 使用 `plt.imshow()` 显示电势分布
- 添加颜色条显示电势值
- 标注正负电荷位置
- 设置合适的标题和坐标轴标签

## 实现提示

1. **数组初始化**：使用 `np.zeros()` 创建电势和电荷密度数组
2. **边界条件**：设置四周边界为0，注意索引范围
3. **电荷分布**：在指定区域设置正负电荷密度
4. **迭代更新**：使用数组切片高效更新内部点
5. **收敛检查**：使用 `np.max(np.abs())` 计算最大变化量
6. **防止无限循环**：设置最大迭代次数限制

## 代码提示

```python
# 网格设置
M = 100
h = 1.0  # 网格间距

# 电荷密度分布
rho = np.zeros((M+1, M+1), float)
rho[60:80, 20:40] = 1.0   # 正电荷
rho[20:40, 60:80] = -1.0  # 负电荷

# 迭代公式（注意h^2项）
phi[1:-1, 1:-1] = 0.25 * (phi[0:-2, 1:-1] + phi[2:, 1:-1] + 
                          phi[1:-1, :-2] + phi[1:-1, 2:] + 
                          h*h * rho[1:-1, 1:-1])
```


## 扩展思考

1. 如何验证数值解的正确性？
2. 网格密度对解的精度有什么影响？
3. 不同的松弛因子会如何影响收敛速度？
4. 如何处理更复杂的边界条件？